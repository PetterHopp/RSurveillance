install.packages("binom")
library("binom", lib.loc="~/R/win-library/3.1")
example(binom.confint)
binom.agresti(25, 200)[1,1:6]
binom.agresti<- function(x, n, conf=0.95) {
# agresti-coull
tails<- 2
z.conf<- qnorm(1 - (1 - conf)/tails, 0, 1)
n.ac<- n + z.conf^2
x.ac<- x + z.conf^2/2
p.ac<- x.ac/n.ac
q.ac<- 1 - p.ac
lc<- p.ac - z.conf*(p.ac*q.ac)^0.5 * n.ac^-0.5
uc<- p.ac + z.conf*(p.ac*q.ac)^0.5 * n.ac^-0.5
return(data.frame(x=x, n=n, proportion=x/n, lower=lc,
upper=uc, conf.level=conf, method="agresti-coull"))
}
binom.agresti(25, 200)[1,1:6]
